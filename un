#!/bin/bash
# undo_nested.sh — fix accidental double nesting from organize_verilog.sh

# Process only directories that have an inner folder with same name
find . -type d | while read -r outer; do
    inner="$outer/$(basename "$outer")"

    # Check if that inner folder exists and contains .v file
    if [ -d "$inner" ] && ls "$inner"/*.v &>/dev/null; then
        echo "Fixing: $inner → $outer"

        # Move .v files up one level
        mv "$inner"/*.v "$outer"/

        # Remove the redundant inner folder
        rmdir "$inner"
    fi
done

echo "✅ All nested folders fixed!"
